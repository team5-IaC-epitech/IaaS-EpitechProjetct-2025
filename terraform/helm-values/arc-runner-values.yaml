# Actions Runner Controller - Runner Scale Set Values
# https://github.com/actions/actions-runner-controller
#
# Configuration for GKE Standard - default mode (no containerMode)
# Default mode uses the full runner image with Node.js and tools included

# GitHub repository/organization URL (configured at deploy time)
githubConfigUrl: "${github_config_url}"

# GitHub App authentication (more secure than PAT)
githubConfigSecret:
  github_app_id: "${github_app_id}"
  github_app_installation_id: "${github_app_installation_id}"

# Runner scaling configuration
minRunners: ${min_runners}
maxRunners: ${max_runners}

runnerGroup: "default"

# No containerMode = default runner mode
# Runner uses ghcr.io/actions/actions-runner:latest with full toolset
# Includes: Node.js, Python, git, and common build tools

# Runner pod template
template:
  spec:
    # Schedule on runner nodes
    tolerations:
      - key: "workload"
        operator: "Equal"
        value: "runners"
        effect: "NoSchedule"

    nodeSelector:
      workload: "runners"

    containers:
      - name: runner
        # Custom runner image with Node.js (built from docker/runner/Dockerfile)
        # Based on official ghcr.io/actions/actions-runner with Node.js 20 added
        image: europe-west9-docker.pkg.dev/iaasepitech/task-manager-dev/github-runner:latest
        resources:
          requests:
            cpu: "500m"
            memory: "1Gi"
          limits:
            cpu: "2000m"
            memory: "4Gi"

controllerServiceAccount:
  namespace: arc-system
  name: arc-gha-runner-scale-set-controller
